<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="UTF-8">
<title>发布任务</title>
<link type="text/css" href="css/style.css" rel="stylesheet">
<link rel="stylesheet" href="css/smoothness/jquery.ui.css" type="text/css" />
<link rel="stylesheet" type="text/css" href="css/css.css"/>
<script type="text/javascript" src="./js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="js/creat_t.js"></script>
<script type="text/javascript" src="js/js3city.js"></script>
<script>
$(function() {
  $('#submit').click(function() {
    //var d = {};
   // var t = $('form').serializeArray();
    //$.each(t, function() {
      //d[this.name] = this.value;
    //});
    //alert(JSON.stringify(d));
    alert(JSON.stringify(GetJsonData()));
    //var json2 = $("form").form2json();
    //alert(json2);

    $.ajax({
        type: "POST",
        url: "http://m.antzb.com/web/tasktemplate/add.do",
        contentType: "application/json; charset=utf-8",
        data: JSON.stringify(GetJsonData()),
        dataType: "json",
        success: function (message) {
            if (message > 0) {
                alert("请求已提交！我们会尽快与您取得联系");
            }
        },
        error: function (message) {
            alert("提交数据失败！");
        }
    });

  });
});

  function GetJsonData() {
    var json = {};
    var t = $('form').serializeArray();
    $.each(t, function() {
      json[this.name] = this.value;
    });
    //alert(JSON.stringify(json));
    return json;
}

/** @serializedParams looks like "prop1=value1&prop2=value2".
Nested property like 'prop.subprop=value' is also supported **/
/**
function paramString2obj (serializedParams) {

var obj={};
function evalThem (str) {
var attributeName = str.split("=")[0];
var attributeValue = str.split("=")[1];
if(!attributeValue){
return ;
}

var array = attributeName.split(".");
for (var i = 1; i < array.length; i++) {
var tmpArray = Array();
tmpArray.push("obj");
for (var j = 0; j < i; j++) {
tmpArray.push(array[j]);
};
var evalString = tmpArray.join(".");
// alert(evalString);
if(!eval(evalString)){
eval(evalString+"={};");
}
};
eval("obj."+attributeName+"='"+attributeValue+"';");

};
var properties = serializedParams.split("&");
for (var i = 0; i < properties.length; i++) {
evalThem(properties[i]);
};
return obj;
}
$.fn.form2json = function(){
var serializedParams = this.serialize();
var obj = paramString2obj(serializedParams);
return JSON.stringify(obj);
}**/
    
</script>
</head>

<body>
<div class="topnav">
  <ul>
    Name
  </ul>
</div>
<div class="leftnav">
  <ul>
        <li class="active"><a href="publish.html" class="a01">发布任务</a></li>
        <li><a href="list.html" class="a02">任务列表</a></li>
        <li><a href="examine.html" class="a03">任务审核</a></li>
  </ul>
</div>
<div class="rightbody">
  <div class="box">
    <form>
      <ul>
        <li class="li_left">任务名称</li>
        <li class="li_right">
          <input type="text" name="taskTitle" value="myTask"  class="inputw500">
        </li>
      </ul>
      <ul>
        <li class="li_left">任务描述</li>
        <li class="li_right">
          <input type="text" name="taskDesc" value="myDescrip" class="inputw500">
        </li>
      </ul>
      <ul>
        <li class="li_left">任务类型</li>
        <li>
          <input type="radio" name="taskType" checked>
          调研</li>
        <li>
          <input type="radio" name="taskType">
          搜罗</li>
        <li>
          <input type="radio" name="taskType">
          检查</li>
      </ul>
      <ul>
        <li class="li_left">是否需要定位</li>
        <li>
          <input type="radio" name="isLocation" >
          是</li>
        <li>
          <input type="radio" name="isLocation" checked>
          否</li>
      </ul>
      <ul>
        <li class="li_left">任务总量</li>
        <li class="li_right">
          <input class="inputw500" name="taskCount" value="20">
        </li>
      </ul>
      <ul>
        <li class="li_left">任务单价</li>
        <li class="li_right">
          <input class="inputw500" name="taskFee" value="100">
        </li>
      </ul>
      <ul>
        <li class="li_left">截⾄日期</li>
        <li class="li_right">
          <input class="inputw200" type="text" name="deadLine"  id="startDate"  />
        </li>
      </ul>
      <ul>
        <li class="li_left">上线日期</li>
        <li class="li_right">
          <input class="inputw200" type="text" readonly name="availableTime"  id="endDate"/>
        </li>
      </ul>
      <ul>
        <li class="li_left">任务城市</li>
        <li>
          <select id="shen" class="inputw200">
          </select>
        </li>
        <li>
          <select id="city" class="inputw200">
          </select>
        </li>
        <li>
          <select id="xian" class="inputw200" >
          </select>
        </li>
      </ul>
      <ul>
        <li class="li_left">任务内容
          <div class="rightanswerbar">
            <ul>
              <li id="t_text" ><img src="images/ico0.jpg" style="vertical-align:middle">文本</li>
              <li id="t_radio"><img src="images/ico0.jpg" style="vertical-align:middle">单选</li>
              <li id="t_select"><img src="images/ico0.jpg" style="vertical-align:middle">多选</li>
              <li id="t_image"><img src="images/ico0.jpg" style="vertical-align:middle">图⽚</li>
              <li id="t_music"><img src="images/ico0.jpg" style="vertical-align:middle">音频</li>
              <li id="t_video"><img src="images/ico0.jpg" style="vertical-align:middle">视频</li>
            </ul>
          </div>
        </li>
        <li class="li_right">
            <div class="list" id="tasklist">
            <div id="listQA" class="listQA">
                <ul id="Q1" class="qagroup">
                    <li id="Q" class="qa">
                        <div id="num" class="num">Q</div>
                        <div class="QTitle" class="QTitle">QTitle1</div>
                    </li>
                    <li id="A">
                        <div>A1</div>
                        <div>A2</div>
                    </li>
                </ul>
                <ul id="Q2" class="qagroup">
                    <li id="Q" class="qa">
                        <div id="num" class="num">Q2</div>
                        <div class="QTitle" class="QTitle">QTitle2</div>
                    </li>
                    <li id="A">
                        <div>A1</div>
                        <div>A2</div>
                    </li>
                </ul>
        
                <ul id="Q3" class="qagroup">
                    <li id="Q" class="qa">
                        <div id="num" class="num">Q3</div>
                        <div class="QTitle" class="QTitle">QTitle3</div>
                    </li>
                    <li id="A">
                        <div>A1</div>
                        <div>A2</div>
                    </li>
                </ul>
            </div>
            </div>
        </li>
      </ul>
      <ul><li class="li_left">&nbsp;</li><li class="li_right">
        <input type="button" value="保存" class="savebtn" id="submit">
      </li></ul>
    </form>
  </div>
</div>
<script type="text/javascript">
	addressInit('shen', 'city', 'xian', '请选择省', '请选择市', '请选择县');
	function showbtn(e){
		var target=document.getElementById(e);
		target.style.display="block";
		}
</script> 
    <script>
function moveSonU(tag,pc){
   
    var tagPre=get_previoussibling(tag);
        var t=document.getElementById(pc);
    if(tagPre!=undefined){
       
        var id1=tag.id
        var id2=tagPre.id
        var t1=tag.getElementsByTagName("div")[0].innerHTML
        var t2=tagPre.getElementsByTagName("div")[0].innerHTML
        tag.id=id2
        tagPre.id=id1;
        
        tag.getElementsByTagName("div")[0].innerHTML=t2
        tagPre.getElementsByTagName("div")[0].innerHTML=t1
        t.insertBefore(tag,tagPre);
    }
}
function moveSonD(tag){
    var tagNext=get_nextsibling(tag);
    if(tagNext!=undefined){
        var id1=tag.id
        var id2=tagNext.id
        var t1=tag.getElementsByTagName("div")[0].innerHTML
        var t2=tagNext.getElementsByTagName("div")[0].innerHTML
        tag.id=id2
        tagNext.id=id1;
        tag.getElementsByTagName("div")[0].innerHTML=t2
        tagNext.getElementsByTagName("div")[0].innerHTML=t1
        insertAfter(tag,tagNext);
    }
}
function get_previoussibling(n){
    if(n.previousSibling!=null){
        var x=n.previousSibling;
        while (x.nodeType!=1)
        {
            x.id=x.previousSibling.id
            x=x.previousSibling;
            
        }  // alert(x.id)
        return x;
     
    }
}
function get_nextsibling(n){
    if(n.nextSibling!=null){
        var x=n.nextSibling;
        while (x.nodeType!=1)
        {
            x=x.nextSibling;
        }//alert(x.id)
        return x;
        
    }
}
function delSon(tag,pc){
   //var tagPre=get_previoussibling(tag);
   var t=document.getElementById(pc); 
   t.removeChild(tag)
   var licount=t.getElementsByTagName("li").length
   for(i=0;i<licount;i++){
       t.getElementsByTagName("li")[i].id="Q"+(i+1)
       t.getElementsByTagName("li")[i].getElementsByTagName("div")[0].innerHTML="Q"+(i+1)
   }
    
}
//DOM没有提供insertAfter()方法
function insertAfter(newElement, targetElement){

    var parent = targetElement.parentNode;

    if (parent.lastChild == targetElement) {

        // 如果最后的节点是目标元素，则直接添加。因为默认是最后
        parent.appendChild(newElement);

    }

    else {

        parent.insertBefore(newElement, targetElement.nextSibling);

        //如果不是，则插入在目标元素的下一个兄弟节点 的前面。也就是目标元素的后面
    }

}

function myOrder(myList,m,mO,mT,mD){
//myList为ul的id值，m为0显示文字，m为1显示图片，mO、mT为文字或图片内容
    var pCon=document.getElementById(myList);
    var pSon=document.getElementsByClassName("qa")
    
    //var pSon=pCon.getElementsByTagName("ul").getElementsByTagName("li");
    for(i=0;i<pSon.length;i++){
        var conTemp=document.createElement("div");
        conTemp.setAttribute("class","control");
        var clickUp=document.createElement("a");
        var clickDown=document.createElement("a");
        var clickDel=document.createElement("a");
        if(m==0){
        var upCon=document.createTextNode(mO);
        var downCon=document.createTextNode(mT);
        var delCon=document.createTextNode(mD)
        }else{
        var upCon=document.createElement("img");
        var downCon=document.createElement("img");
        var delCon=document.createElement("img");
        upCon.setAttribute("src",mO);
        downCon.setAttribute("src",mT);
        delCon.setAttribute("src",mD);
        }
        clickUp.appendChild(upCon);
        clickUp.setAttribute("href","#");
        clickDown.appendChild(downCon);
        clickDown.setAttribute("href","#");
        clickDel.appendChild(delCon);
        clickDel.setAttribute("href","#");
        pSon[i].appendChild(conTemp);
        conTemp.appendChild(clickUp);
        conTemp.appendChild(clickDown);
        conTemp.appendChild(clickDel);
        clickUp.onclick=function(){
           // alert(this.parentNode.parentNode.parentNode.id)
            moveSonU(this.parentNode.parentNode.parentNode,myList);
        }
        clickDown.onclick=function(){
            moveSonD(this.parentNode.parentNode.parentNode);
        }
        clickDel.onclick=function(){
            delSon(this.parentNode.parentNode.parentNode,myList);
        }
    }
}
myOrder("listQA",1,"images/ico3.jpg","images/ico2.jpg","images/ico4.jpg");
</script>
<script type="text/javascript" src="js/jquery.js"></script> 
<script type="text/javascript" src="js/jquery.ui.js"></script> 
<script type="text/javascript" src="js/moment.min.js"></script> 
<script type="text/javascript" src="js/hotel/hotel.search.js"></script> 
<script type="text/javascript" src="js/stay.js"></script>
<div style="text-align:center;margin:50px 0; font:normal 14px/24px 'MicroSoft YaHei';"> </div>
</body>
</html>
